<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="x-ua-compatible" content="ie=edge">
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.5.2/js/bootstrap.min.js" integrity="sha512-M5KW3ztuIICmVIhjSqXe01oV2bpe248gOxqmlcYrEzAvws7Pw3z6BK0iGbrwvdrUQUhi3eXgtxp5I8PDo9YfjQ==" crossorigin="anonymous"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<link type="text/css" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.5.2/css/bootstrap.min.css" integrity="sha512-MoRNloxbStBcD8z3M/2BmnT+rg4IsMxPkXaGh2zD6LGNNFE80W3onsAhRcMAMrSoyWL9xD7Ert0men7vR8LUZg==" crossorigin="anonymous" />
<title>cis ubuntu linux 20.04 lts benchmark report</title>
</head>
<body>
<h2 class="text-center">cis ubuntu linux 20.04 lts benchmark report</h2>
<hr>
<div class="container">  5.1.1 Ensure cron daemon is enabled and running</div><div class="container">- Description:</div><div class="container">The cron daemon is used to execute batch jobs on the system.</div><div class="container">Note: Other methods, such as systemd timers, exist for scheduling jobs. If another method is used, cron should be removed, and the alternate method should be secured in accordance with local site policy.</div><div class="container">- Rationale:</div><div class="container">While there may not be user jobs that need to be run on the system, the system does have maintenance jobs that may include security monitoring that have to run, and cron is used to execute them.</div><div class="container">- Current settings:</div><div class="container">enabled</div><div class="container">active(running)</div><div class="container">- Score pattern:</div><div class="container">== systemctl is-enabled cron | grep 'enabled' && systemctl status cron | grep 'Active: active (running)' | awk '{print $2 $3}' | grep 'active(running)'</div><div class="text-center container badge-success">scored</div><div class="container">  5.1.2 Ensure permissions on /etc/crontab are configured</div><div class="container">- Description:</div><div class="container">The /etc/crontab file is used by cron to control its own jobs. The commands in this item make sure that root is the user and group owner of the file and that only the owner can access the file.</div><div class="container">Note: Other methods, such as systemd timers, exist for scheduling jobs. If another method is used, cron should be removed, and the alternate method should be secured in accordance with local site policy.</div><div class="container">- Rationale:</div><div class="container">This file contains information on what system jobs are run by cron. Write access to these files could provide unprivileged users with the ability to elevate their privileges. Read access to these files could provide users with the ability to gain insight on system jobs that run on the system and could provide them a way to gain unauthorized privileged access.</div><div class="container">- Current settings:</div><div class="container">  File: /etc/crontab</div><div class="container">Access: (0644/-rw-r--r--)  Uid: (    0/    root)   Gid: (    0/    root)</div><div class="container">- Score pattern:</div><div class="container">== stat /etc/crontab | grep 'File:\|Access: (0600/-rw-------) Uid: ( 0/ root) Gid: ( 0/ root)'</div><div class="container">- Command to execute:</div><div class="container">chown root:root /etc/crontab && chmod og-rwx /etc/crontab</div><div class="text-center container badge-danger">not scored (skipped)</div><div class="container">  5.1.3 Ensure permissions on /etc/cron.hourly are configured</div><div class="container">- Description:</div><div class="container">This directory contains system cron jobs that need to run on an hourly basis. The files in this directory cannot be manipulated by the crontab command, but are instead edited by system administrators using a text editor. The commands below restrict read/write and search access to user and group root, preventing regular users from accessing this directory.</div><div class="container">Note: Other methods, such as systemd timers, exist for scheduling jobs. If another method is used, cron should be removed, and the alternate method should be secured in accordance with local site policy.</div><div class="container">- Rationale:</div><div class="container">Granting write access to this directory for non-privileged users could provide them the means for gaining unauthorized elevated privileges. Granting read access to this directory could give an unprivileged user insight in how to gain elevated privileges or circumvent auditing controls.</div><div class="container">- Current settings:</div><div class="container">  File: /etc/cron.hourly/</div><div class="container">Access: (0755/drwxr-xr-x)  Uid: (    0/    root)   Gid: (    0/    root)</div><div class="container">- Score pattern:</div><div class="container">== stat /etc/cron.hourly/ | grep 'File:\|Access: (0700/drwx------) Uid: ( 0/ root) Gid: ( 0/ root)'</div><div class="container">- Command to execute:</div><div class="container">chown root:root /etc/cron.hourly/ && chmod og-rwx /etc/cron.hourly/</div><div class="text-center container badge-danger">not scored (skipped)</div><div class="container">  5.1.4 Ensure permissions on /etc/cron.daily are configured</div><div class="container">- Description:</div><div class="container">The /etc/cron.daily directory contains system cron jobs that need to run on a daily basis. The files in this directory cannot be manipulated by the crontab command, but are instead edited by system administrators using a text editor. The commands below restrict read/write and search access to user and group root, preventing regular users from accessing this directory.</div><div class="container">Note: Other methods, such as systemd timers, exist for scheduling jobs. If another method is used, cron should be removed, and the alternate method should be secured in accordance with local site policy.</div><div class="container">- Rationale:</div><div class="container">Granting write access to this directory for non-privileged users could provide them the means for gaining unauthorized elevated privileges. Granting read access to this directory could give an unprivileged user insight in how to gain elevated privileges or circumvent auditing controls.</div><div class="container">- Current settings:</div><div class="container">  File: /etc/cron.daily/</div><div class="container">Access: (0755/drwxr-xr-x)  Uid: (    0/    root)   Gid: (    0/    root)</div><div class="container">- Score pattern:</div><div class="container">== stat /etc/cron.daily/ | grep 'File:\|Access: (0700/drwx------) Uid: ( 0/ root) Gid: ( 0/ root)'</div><div class="container">- Command to execute:</div><div class="container">chown root:root /etc/cron.daily/ && chmod og-rwx /etc/cron.daily/</div><div class="text-center container badge-danger">not scored (skipped)</div><div class="container">  5.1.5 Ensure permissions on /etc/cron.weekly are configured</div><div class="container">- Description:</div><div class="container">The /etc/cron.weekly directory contains system cron jobs that need to run on a weekly basis. The files in this directory cannot be manipulated by the crontab command, but are instead edited by system administrators using a text editor. The commands below restrict read/write and search access to user and group root, preventing regular users from accessing this directory.</div><div class="container">Note: Other methods, such as systemd timers, exist for scheduling jobs. If another method is used, cron should be removed, and the alternate method should be secured in accordance with local site policy.</div><div class="container">- Rationale:</div><div class="container">Granting write access to this directory for non-privileged users could provide them the means for gaining unauthorized elevated privileges. Granting read access to this directory could give an unprivileged user insight in how to gain elevated privileges or circumvent auditing controls.</div><div class="container">- Current settings:</div><div class="container">  File: /etc/cron.weekly/</div><div class="container">Access: (0755/drwxr-xr-x)  Uid: (    0/    root)   Gid: (    0/    root)</div><div class="container">- Score pattern:</div><div class="container">== stat /etc/cron.weekly/ | grep 'File:\|Access: (0700/drwx------) Uid: ( 0/ root) Gid: ( 0/ root)'</div><div class="container">- Command to execute:</div><div class="container">chown root:root /etc/cron.weekly/ && chmod og-rwx /etc/cron.weekly/</div><div class="text-center container badge-danger">not scored (skipped)</div><div class="container">  5.1.6 Ensure permissions on /etc/cron.monthly are configured</div><div class="container">- Description:</div><div class="container">The /etc/cron.monthly directory contains system cron jobs that need to run on a monthly basis. The files in this directory cannot be manipulated by the crontab command, but are instead edited by system administrators using a text editor. The commands below restrict read/write and search access to user and group root, preventing regular users from accessing this directory.</div><div class="container">Note: Other methods, such as systemd timers, exist for scheduling jobs. If another method is used, cron should be removed, and the alternate method should be secured in accordance with local site policy.</div><div class="container">- Rationale:</div><div class="container">Granting write access to this directory for non-privileged users could provide them the means for gaining unauthorized elevated privileges. Granting read access to this directory could give an unprivileged user insight in how to gain elevated privileges or circumvent auditing controls.</div><div class="container">- Current settings:</div><div class="container">  File: /etc/cron.monthly/</div><div class="container">Access: (0755/drwxr-xr-x)  Uid: (    0/    root)   Gid: (    0/    root)</div><div class="container">- Score pattern:</div><div class="container">== stat /etc/cron.monthly/ | grep 'File:\|Access: (0700/drwx------) Uid: ( 0/ root) Gid: ( 0/ root)'</div><div class="container">- Command to execute:</div><div class="container">chown root:root /etc/cron.monthly/ && chmod og-rwx /etc/cron.monthly/</div><div class="text-center container badge-danger">not scored (skipped)</div><div class="container">  5.1.7 Ensure permissions on /etc/cron.d are configured</div><div class="container">- Description:</div><div class="container">The /etc/cron.d directory contains system cron jobs that need to run in a similar manner to the hourly, daily weekly and monthly jobs from /etc/crontab, but require more granular control as to when they run. The files in this directory cannot be manipulated by the crontab command, but are instead edited by system administrators using a text editor. The commands below restrict read/write and search access to user and group root, preventing regular users from accessing this directory.</div><div class="container">Note: Other methods, such as systemd timers, exist for scheduling jobs. If another method is used, cron should be removed, and the alternate method should be secured in accordance with local site policy.</div><div class="container">- Rationale:</div><div class="container">Granting write access to this directory for non-privileged users could provide them the means for gaining unauthorized elevated privileges. Granting read access to this directory could give an unprivileged user insight in how to gain elevated privileges or circumvent auditing controls.</div><div class="container">- Current settings:</div><div class="container">  File: /etc/cron.d/</div><div class="container">Access: (0755/drwxr-xr-x)  Uid: (    0/    root)   Gid: (    0/    root)</div><div class="container">- Score pattern:</div><div class="container">== stat /etc/cron.d/ | grep 'File:\|Access: (0700/drwx------) Uid: ( 0/ root) Gid: ( 0/ root)'</div><div class="container">- Command to execute:</div><div class="container">chown root:root /etc/cron.d/ && chmod og-rwx /etc/cron.d/</div><div class="text-center container badge-danger">not scored (skipped)</div><div class="container">  5.1.8 Ensure cron is restricted to authorized users</div><div class="container">- Description:</div><div class="container">Configure /etc/cron.allow to allow specific users to use this service. If /etc/cron.allow does not exist, then /etc/cron.deny is checked. Any user not specifically defined in this file is allowed to use cron. By removing the file, only users in /etc/cron.allow are allowed to use cron.</div><div class="container">Notes:</div><div class="container">  • Other methods, such as systemd timers, exist for scheduling jobs. If another method is used, cron should be removed, and the alternate method should be secured in accordance with local site policy</div><div class="container">  • Even though a given user is not listed in cron.allow, cron jobs can still be run as that user</div><div class="container">  • The cron.allow file only controls administrative access to the crontab command for scheduling and modifying cron jobs</div><div class="container">- Rationale:</div><div class="container">On many systems, only the system administrator is authorized to schedule cron jobs. Using the cron.allow file to control who can run cron jobs enforces this policy. It is easier to manage an allow list than a deny list. In a deny list, you could potentially add a user ID to the system and forget to add it to the deny files.</div><div class="container">- Current settings:</div><div class="container">- Score pattern:</div><div class="container">== </div><div class="text-center container badge-success">scored</div><div class="container">  5.1.9 Ensure at is restricted to authorized users</div><div class="container">- Description:</div><div class="container">Configure /etc/at.allow to allow specific users to use this service. If /etc/at.allow does not exist, then /etc/at.deny is checked. Any user not specifically defined in this file is allowed to use at. By removing the file, only users in /etc/at.allow are allowed to use at.</div><div class="container">Note: Other methods, such as systemd timers, exist for scheduling jobs. If another method is used, at should be removed, and the alternate method should be secured in accordance with local site policy</div><div class="container">- Rationale:</div><div class="container">On many systems, only the system administrator is authorized to schedule at jobs. Using the at.allow file to control who can run at jobs enforces this policy. It is easier to manage an allow list than a deny list. In a deny list, you could potentially add a user ID to the system and forget to add it to the deny files.</div><div class="container">- Current settings:</div><div class="container">  File: /etc/at.deny</div><div class="container">  Size: 144       	Blocks: 8          IO Block: 4096   regular file</div><div class="container">Device: 802h/2050d	Inode: 4981404     Links: 1</div><div class="container">Access: (0640/-rw-r-----)  Uid: (    0/    root)   Gid: (    1/  daemon)</div><div class="container">Access: 2020-08-16 12:49:35.177198214 +0300</div><div class="container">Modify: 2018-11-12 19:11:53.000000000 +0200</div><div class="container">Change: 2020-08-16 12:49:35.177198214 +0300</div><div class="container"> Birth: -</div><div class="container">- Score pattern:</div><div class="container">== </div><div class="container">- Command to execute:</div><div class="container">rm /etc/at.deny && touch /etc/at.allow && chown root:root /etc/at.allow && chmod g-wx,o-rwx /etc/at.allow</div><div class="text-center container badge-danger">not scored (skipped)</div><div class="container">  5.2.1 Ensure permissions on /etc/ssh/sshd_config are configured</div><div class="container">- Description:</div><div class="container">The /etc/ssh/sshd_config file contains configuration specifications for sshd. The command below sets the owner and group of the file to root.</div><div class="container">- Rationale:</div><div class="container">The /etc/ssh/sshd_config file needs to be protected from unauthorized changes by non-privileged users.</div><div class="container">- Current settings:</div><div class="container">  File: /etc/ssh/sshd_config</div><div class="container">Access: (0600/-rw-------)  Uid: (    0/    root)   Gid: (    0/    root)</div><div class="container">- Score pattern:</div><div class="container">== stat /etc/ssh/sshd_config | grep 'File:\|Access: (0600/-rw-------) Uid: ( 0/ root) Gid: ( 0/ root)'</div><div class="text-center container badge-success">scored</div><div class="container">  5.2.2 Ensure permissions on SSH private host key files are configured</div><div class="container">- Description:</div><div class="container">An SSH private key is one of two files used in SSH public key authentication. In this authentication method, The possession of the private key is proof of identity. Only a private key that corresponds to a public key will be able to authenticate successfully. The private keys need to be stored and handled carefully, and no copies of the private key should be distributed.</div><div class="container">- Rationale:</div><div class="container">If an unauthorized user obtains the private SSH host key file, the host could be impersonated.</div><div class="container">- Current settings:</div><div class="container">  File: /etc/ssh/ssh_host_ed25519_key</div><div class="container">Access: (0600/-rw-------)  Uid: (    0/    root)   Gid: (    0/    root)</div><div class="container">  File: /etc/ssh/ssh_host_rsa_key</div><div class="container">Access: (0600/-rw-------)  Uid: (    0/    root)   Gid: (    0/    root)</div><div class="container">  File: /etc/ssh/ssh_host_ecdsa_key</div><div class="container">Access: (0600/-rw-------)  Uid: (    0/    root)   Gid: (    0/    root)</div><div class="container">  File: /etc/ssh/ssh_host_dsa_key</div><div class="container">Access: (0600/-rw-------)  Uid: (    0/    root)   Gid: (    0/    root)</div><div class="container">- Score pattern:</div><div class="container">== find /etc/ssh -xdev -type f -name 'ssh_host_*_key' | xargs stat | grep 'File:\|Access: (0600/-rw-------) Uid: ( 0/ root) Gid: ( 0/ root)'</div><div class="text-center container badge-success">scored</div><div class="container">  5.2.3 Ensure permissions on SSH public host key files are configured</div><div class="container">- Description:</div><div class="container">An SSH public key is one of two files used in SSH public key authentication. In this authentication method, a public key is a key that can be used for verifying digital signatures generated using a corresponding private key. Only a public key that corresponds to a private key will be able to authenticate successfully.</div><div class="container">- Rationale:</div><div class="container">If a public host key file is modified by an unauthorized user, the SSH service may be compromised.</div><div class="container">- Current settings:</div><div class="container">  File: /etc/ssh/ssh_host_ed25519_key.pub</div><div class="container">Access: (0644/-rw-r--r--)  Uid: (    0/    root)   Gid: (    0/    root)</div><div class="container">  File: /etc/ssh/ssh_host_dsa_key.pub</div><div class="container">Access: (0644/-rw-r--r--)  Uid: (    0/    root)   Gid: (    0/    root)</div><div class="container">  File: /etc/ssh/ssh_host_ecdsa_key.pub</div><div class="container">Access: (0644/-rw-r--r--)  Uid: (    0/    root)   Gid: (    0/    root)</div><div class="container">  File: /etc/ssh/ssh_host_rsa_key.pub</div><div class="container">Access: (0644/-rw-r--r--)  Uid: (    0/    root)   Gid: (    0/    root)</div><div class="container">- Score pattern:</div><div class="container">== find /etc/ssh -xdev -type f -name 'ssh_host_*_key.pub' | xargs stat | grep 'File\|Access: (0644/-rw-r--r--) Uid: ( 0/ root) Gid: ( 0/ root)'</div><div class="text-center container badge-success">scored</div><div class="container">  5.2.4 Ensure SSH LogLevel is appropriate</div><div class="container">- Description:</div><div class="container">LogLevel gives the verbosity level that is used when logging messages from sshd(8). The possible values are: QUIET, FATAL, ERROR, INFO, VERBOSE, DEBUG, DEBUG1, DEBUG2 and DEBUG3.</div><div class="container">Note: The newer OpenSSH releases do not need a verbose mode setting anymore as the required SSH key activity information is written into the syslog by the default OpenSSH config</div><div class="container">- Rationale:</div><div class="container">SSH provides several logging levels with varying amounts of verbosity. The DEBUG loglevels are specifically not recommended other than for strictly debugging SSH communications since it provides so much data that it is difficult to identify important security information and may violate the privacy of users.</div><div class="container">LogLevel INFO is the basic level that records login activity of SSH users. In many situations, such as Incident Response, it is important to determine when a particular user was active on a system. The logout record can eliminate those users who disconnected, which helps narrow the field</div><div class="container">- Current settings:</div><div class="container">loglevel INFO</div><div class="container">- Score pattern:</div><div class="container">!= sshd -T | grep --extended-regexp 'loglevel DEBUG|loglevel DEBUG1|loglevel DEBUG2|loglevel DEBUG3'</div><div class="text-center container badge-success">scored</div><div class="container">  5.2.5 Ensure SSH X11 forwarding is disabled</div><div class="container">- Description:</div><div class="container">The X11Forwarding parameter provides the ability to tunnel X11 traffic through the connection to enable remote graphic connections.</div><div class="container">- Rationale:</div><div class="container">Disable X11 forwarding unless there is an operational requirement to use X11 applications directly. There is a small risk that the remote X11 servers of users who are logged in via SSH with X11 forwarding could be compromised by other users on the X11 server.</div><div class="container">Note that even if X11 forwarding is disabled, users can always install their own forwarders.</div><div class="container">- Current settings:</div><div class="container">x11forwarding yes</div><div class="container">- Score pattern:</div><div class="container">== sshd -T | grep -E 'x11forwarding no'</div><div class="container">- Command to execute:</div><div class="container">sed --in-place "s/^.*X11Forwarding.*$/X11Forwarding no/" /etc/ssh/sshd_config</div><div class="text-center container badge-danger">not scored (skipped)</div><div class="container">  5.2.6 Ensure SSH MaxAuthTries is set to 4 or less</div><div class="container">- Description:</div><div class="container">The MaxAuthTries parameter specifies the maximum number of authentication attempts permitted per connection. When the login failure count reaches half the number, error messages will be written to the syslog file detailing the login failure.</div><div class="container">Note: Local site policy may be more restrictive.</div><div class="container">- Rationale:</div><div class="container">Setting the MaxAuthTries parameter to a low number will minimize the risk of successful brute force attacks to the SSH server. While the recommended setting is 4, set the number based on site policy.</div><div class="container">- Current settings:</div><div class="container">6</div><div class="container">- Score pattern:</div><div class="container">-le 4</div><div class="container">- Command to execute:</div><div class="container">set_value_gt0 "-le" "$check_command" "$score_pattern" "$x"</div><div class="text-center container badge-danger">not scored (skipped)</div><div class="container">  5.2.7 Ensure SSH IgnoreRhosts is enabled</div><div class="container">- Description:</div><div class="container">The IgnoreRhosts parameter specifies that .rhosts and .shosts files will not be used in RhostsRSAAuthentication or HostbasedAuthentication.</div><div class="container">- Rationale:</div><div class="container">Setting this parameter forces users to enter a password when authenticating with ssh.</div><div class="container">- Current settings:</div><div class="container">ignorerhosts yes</div><div class="container">- Score pattern:</div><div class="container">== sshd -T | grep -E 'ignorerhosts yes'</div><div class="text-center container badge-success">scored</div><div class="container">  5.2.8 Ensure SSH HostbasedAuthentication is disabled</div><div class="container">- Description:</div><div class="container">The HostbasedAuthentication parameter specifies if authentication is allowed through trusted hosts via the user of .rhosts, or /etc/hosts.equiv, along with successful public key client host authentication. This option only applies to SSH Protocol Version 2.</div><div class="container">- Rationale:</div><div class="container">Even though the .rhosts files are ineffective if support is disabled in /etc/pam.conf, disabling the ability to use .rhosts files in SSH provides an additional layer of protection.</div><div class="container">- Current settings:</div><div class="container">hostbasedauthentication no</div><div class="container">- Score pattern:</div><div class="container">== sshd -T | grep -E 'hostbasedauthentication no'</div><div class="text-center container badge-success">scored</div><div class="container">  5.2.9 Ensure SSH root login is disabled</div><div class="container">- Description:</div><div class="container">The PermitRootLogin parameter specifies if the root user can log in using ssh. The default is no.</div><div class="container">- Rationale:</div><div class="container">Disallowing root logins over SSH requires system admins to authenticate using their own individual account, then escalating to root via sudo or su. This in turn limits opportunity for non-repudiation and provides a clear audit trail in the event of a security incident.</div><div class="container">- Current settings:</div><div class="container">permitrootlogin without-password</div><div class="container">- Score pattern:</div><div class="container">== sshd -T | grep -E 'permitrootlogin no'</div><div class="container">- Command to execute:</div><div class="container">sed --in-place "s/^.*PermitRootLogin.*$/PermitRootLogin no/" /etc/ssh/sshd_config</div><div class="text-center container badge-danger">not scored (skipped)</div><div class="container">  5.2.10 Ensure SSH PermitEmptyPasswords is disabled</div><div class="container">- Description:</div><div class="container">The PermitEmptyPasswords parameter specifies if the SSH server allows login to accounts with empty password strings.</div><div class="container">- Rationale:</div><div class="container">Disallowing remote shell access to accounts that have an empty password reduces the probability of unauthorized access to the system.</div><div class="container">- Current settings:</div><div class="container">permitemptypasswords no</div><div class="container">- Score pattern:</div><div class="container">== sshd -T | grep -E 'permitemptypasswords no'</div><div class="text-center container badge-success">scored</div><div class="container">  5.2.11 Ensure SSH PermitUserEnvironment is disabled</div><div class="container">- Description:</div><div class="container">The PermitUserEnvironment option allows users to present environment options to the ssh daemon.</div><div class="container">- Rationale:</div><div class="container">Permitting users the ability to set environment variables through the SSH daemon could potentially allow users to bypass security controls (e.g. setting an execution path that has ssh executing trojan'd programs).</div><div class="container">- Current settings:</div><div class="container">permituserenvironment no</div><div class="container">- Score pattern:</div><div class="container">== sshd -T | grep -E 'permituserenvironment no'</div><div class="text-center container badge-success">scored</div><div class="container">  5.2.12 Ensure only strong Ciphers are used</div><div class="container">- Description:</div><div class="container">This variable limits the ciphers that SSH can use during communication.</div><div class="container">Notes:</div><div class="container">  • Some organizations may have stricter requirements for approved ciphers</div><div class="container">  • Ensure that ciphers used are in compliance with site policy</div><div class="container">  • The only "strong" ciphers currently FIPS 140-2 compliant are:</div><div class="container">    ° aes256-ctr</div><div class="container">    ° aes192-ctr</div><div class="container">    ° aes128-ctr</div><div class="container">  • Supported ciphers in openSSH 8.2:</div><div class="container">3des-cbc, aes128-cbc, aes192-cbc, aes256-cbc, aes128-ctr, aes192-ctr, aes256-ctr, aes128-gcm@openssh.com, aes256-gcm@openssh.com, chacha20-poly1305@openssh.com</div><div class="container">- Rationale:</div><div class="container">Weak ciphers that are used for authentication to the cryptographic module cannot be relied upon to provide confidentiality or integrity, and system data may be compromised</div><div class="container">  • The Triple DES ciphers, as used in SSH, have a birthday bound of approximately four billion blocks, which makes it easier for remote attackers to obtain cleartext data via a birthday attack against a long-duration encrypted session, aka a "Sweet32" attack</div><div class="container">  • Error handling in the SSH protocol; Client and Server, when using a block cipher algorithm in Cipher Block Chaining (CBC) mode, makes it easier for remote attackers to recover certain plaintext data from an arbitrary block of ciphertext in an SSH session via unknown vectors</div><div class="container">- Current settings:</div><div class="container">ciphers chacha20-poly1305@openssh.com,aes128-ctr,aes192-ctr,aes256-ctr,aes128-gcm@openssh.com,aes256-gcm@openssh.com</div><div class="container">- Score pattern:</div><div class="container">!= sshd -T | grep --extended-regexp 'ciphers\|3des-cbc|aes128-cbc|aes192-cbc|aes256-cbc'</div><div class="text-center container badge-success">scored</div><div class="container">  5.2.13 Ensure only strong MAC algorithms are used</div><div class="container">- Description:</div><div class="container">This variable limits the types of MAC algorithms that SSH can use during communication.</div><div class="container">Notes:</div><div class="container">  • Some organizations may have stricter requirements for approved MACs</div><div class="container">  • Ensure that MACs used are in compliance with site policy</div><div class="container">  • The only "strong" MACs currently FIPS 140-2 approved are:</div><div class="container">    ° hmac-sha2-256</div><div class="container">    ° hmac-sha2-512</div><div class="container">  • The Supported MACs are:</div><div class="container">hmac-md5, hmac-md5-96, hmac-sha1, hmac-sha1-96, hmac-sha2-256, hmac-sha2-512, umac-64@openssh.com, umac-128@openssh.com, hmac-md5-etm@openssh.com, hmac-md5-96-etm@openssh.com, hmac-sha1-etm@openssh.com, hmac-sha1-96-etm@openssh.com, hmac-sha2-256-etm@openssh.com, hmac-sha2-512-etm@openssh.com, umac-64-etm@openssh.com, umac-128-etm@openssh.com</div><div class="container">- Rationale:</div><div class="container">MD5 and 96-bit MAC algorithms are considered weak and have been shown to increase exploitability in SSH downgrade attacks. Weak algorithms continue to have a great deal of attention as a weak spot that can be exploited with expanded computing power. An attacker that breaks the algorithm could take advantage of a MiTM position to decrypt the SSH tunnel and capture credentials and information.</div><div class="container">- Current settings:</div><div class="container">macs umac-64-etm@openssh.com,umac-128-etm@openssh.com,hmac-sha2-256-etm@openssh.com,hmac-sha2-512-etm@openssh.com,hmac-sha1-etm@openssh.com,umac-64@openssh.com,umac-128@openssh.com,hmac-sha2-256,hmac-sha2-512,hmac-sha1</div><div class="container">- Score pattern:</div><div class="container">!= sshd -T | grep --extended-regexp 'MACs\|hmac-md5|hmac-md5-96|hmac-ripemd160|hmac-sha1|hmac-sha1-96|umac-64@openssh.com|umac-128@openssh.com|hmac-md5-etm@openssh.com|hmac-md5-96-etm@openssh.com|hmac-ripemd160-etm@openssh.com|hmac-sha1-etm@openssh.com|hmac-sha1-96-etm@openssh.com|umac-64-etm@openssh.com|umac-128-etm@openssh.com'</div><div class="container">- Command to execute:</div><div class="text-center container badge-danger">not scored (skipped)</div><div class="container">  5.2.14 Ensure only strong Key Exchange algorithms are used</div><div class="container">- Description:</div><div class="container">Key exchange is any method in cryptography by which cryptographic keys are exchanged between two parties, allowing use of a cryptographic algorithm. If the sender and receiver wish to exchange encrypted messages, each must be equipped to encrypt messages to be sent and decrypt messages received.</div><div class="container">Notes:</div><div class="container">  • Kex algorithms have a higher preference the earlier they appear in the list</div><div class="container">  • Some organizations may have stricter requirements for approved Key exchange algorithms</div><div class="container">  • Ensure that Key exchange algorithms used are in compliance with site policy</div><div class="container">  • The only Key Exchange Algorithms currently FIPS 140-2 approved are:</div><div class="container">    ° ecdh-sha2-nistp256</div><div class="container">    ° ecdh-sha2-nistp384</div><div class="container">    ° ecdh-sha2-nistp521</div><div class="container">    ° diffie-hellman-group-exchange-sha256</div><div class="container">    ° diffie-hellman-group16-sha512</div><div class="container">    ° diffie-hellman-group18-sha512</div><div class="container">    ° diffie-hellman-group14-sha256</div><div class="container">  • The Key Exchange algorithms supported by OpenSSH 8.2 are:</div><div class="container">curve25519-sha256, curve25519-sha256@libssh.org, diffie-hellman-group1-sha1, diffie-hellman-group14-sha1, diffie-hellman-group14-sha256, diffie-hellman-group16-sha512, diffie-hellman-group18-sha512, diffie-hellman-group-exchange-sha1, diffie-hellman-group-exchange-sha256, ecdh-sha2-nistp256,ecdh-sha2-nistp384, ecdh-sha2-nistp521, sntrup4591761x25519-sha512@tinyssh.org</div><div class="container">- Rationale:</div><div class="container">Key exchange methods that are considered weak should be removed. A key exchange method may be weak because too few bits are used, or the hashing algorithm is considered too weak. Using weak algorithms could expose connections to man-in-the-middle attacks.</div><div class="container">- Current settings:</div><div class="container">gssapikexalgorithms gss-gex-sha1-,gss-group14-sha1-</div><div class="container">kexalgorithms curve25519-sha256,curve25519-sha256@libssh.org,ecdh-sha2-nistp256,ecdh-sha2-nistp384,ecdh-sha2-nistp521,diffie-hellman-group-exchange-sha256,diffie-hellman-group16-sha512,diffie-hellman-group18-sha512,diffie-hellman-group14-sha256</div><div class="container">- Score pattern:</div><div class="container">== sshd -T | grep -E 'kexalgorithms\|diffie-hellman-group1-sha1|diffie-hellman-group14-sha1|diffie-hellman-group-exchange-sha1'</div><div class="container">- Command to execute:</div><div class="text-center container badge-danger">not scored (skipped)</div><div class="container">  5.2.15 Ensure SSH Idle Timeout Interval is configured</div><div class="container">- Description:</div><div class="container">The two options ClientAliveInterval and ClientAliveCountMax control the timeout of ssh sessions.</div><div class="container">  • ClientAliveInterval sets a timeout interval in seconds after which if no data has been received from the client, sshd will send a message through the encrypted channel to request a response from the client. The default is 0, indicating that these messages will not be sent to the client</div><div class="container">  • ClientAliveCountMax sets the number of client alive messages which may be sent without sshd receiving any messages back from the client.</div><div class="container">If this threshold is reached while client alive messages are being sent, sshd will disconnect the client, terminating the session.</div><div class="container">The default value is 3.</div><div class="container">    ° The client alive messages are sent through the encrypted channel</div><div class="container">    ° Setting ClientAliveCountMax to 0 disables connection termination</div><div class="container">Example: If the ClientAliveInterval is set to 15 seconds and the ClientAliveCountMax is set to 3, the client ssh session will be terminated after 45 seconds of idle time.</div><div class="container">Note: Local site policy may be more restrictive.</div><div class="container">- Rationale:</div><div class="container">Having no timeout value associated with a connection could allow an unauthorized user access to another user's ssh session (e.g. user walks away from their computer and doesn't lock the screen). Setting a timeout value reduces this risk.</div><div class="container">  • The recommended ClientAliveInterval setting is 300 seconds (5 minutes)</div><div class="container">  • The recommended ClientAliveCountMax setting is 3</div><div class="container">  • The ssh session would send three keep alive messages at 5 minute intervals. If no response is received after the third keep alive message, the ssh session would be terminated after 15 minutes.</div><div class="container">- Current settings:</div><div class="container">clientaliveinterval 0</div><div class="container">clientalivecountmax 3</div><div class="container">- Score pattern:</div><div class="container">== </div><div class="container">- Command to execute:</div><div class="text-center container badge-danger">not scored (skipped)</div><div class="container">  5.2.16 Ensure SSH LoginGraceTime is set to one minute or less</div><div class="container">- Description:</div><div class="container">The LoginGraceTime parameter specifies the time allowed for successful authentication to the SSH server. The longer the Grace period is the more open unauthenticated connections can exist. Like other session controls in this session the Grace Period should be limited to appropriate organizational limits to ensure the service is available for needed access.</div><div class="container">Note: Local site policy may be more restrictive</div><div class="container">- Rationale:</div><div class="container">Setting the LoginGraceTime parameter to a low number will minimize the risk of successful brute force attacks to the SSH server. It will also limit the number of concurrent unauthenticated connections While the recommended setting is 60 seconds (1 Minute), set the number based on site policy.</div><div class="container">- Current settings:</div><div class="container">120</div><div class="container">- Score pattern:</div><div class="container">-le 60</div><div class="container">- Command to execute:</div><div class="container">set_value_gt0 "-le" "$check_command" "$score_pattern" "$x"</div><div class="text-center container badge-danger">not scored (skipped)</div><div class="container">  5.2.17 Ensure SSH access is limited</div><div class="container">- Description:</div><div class="container">There are several options available to limit which users and group can access the system via SSH. It is recommended that at least one of the following options be leveraged:</div><div class="container">  • AllowUsers - Gives the system administrator the option of allowing specific users to ssh into the system</div><div class="container">    ° The list consists of space separated user names</div><div class="container">    ° Numeric user IDs are not recognized with this variable</div><div class="container">    ° A system administrator may restrict user access further by only allowing the allowed users to log in from a particular host by specifying the entry as <user>@<host></div><div class="container">  • AllowGroups - Gives the system administrator the option of allowing specific groups of users to ssh into the system</div><div class="container">    ° The list consists of space separated group names</div><div class="container">    ° Numeric group IDs are not recognized with this variable</div><div class="container">  • DenyUsers - Gives the system administrator the option of denying specific users to ssh into the system</div><div class="container">    ° The list consists of space separated user names</div><div class="container">    ° Numeric user IDs are not recognized with this variable</div><div class="container">    ° If a system administrator wants to restrict user access further by specifically denying a user's access from a particular host by specifying the entry as <user>@<host></div><div class="container">  • DenyGroups - Gives the system administrator the option of denying specific groups of users to ssh into the system</div><div class="container">    ° The list consists of space separated group names</div><div class="container">    ° Numeric group IDs are not recognized with this variable</div><div class="container">- Rationale:</div><div class="container">Restricting which users can remotely access the system via SSH will help ensure that only authorized users access the system.</div><div class="container">- Current settings:</div><div class="container">- Score pattern:</div><div class="container">== </div><div class="text-center container badge-success">scored</div><div class="container">  5.2.18 Ensure SSH warning banner is configured</div><div class="container">- Description:</div><div class="container">The Banner parameter specifies a file whose contents must be sent to the remote user before authentication is permitted. By default, no banner is displayed.</div><div class="container">- Rationale:</div><div class="container">Banners are used to warn connecting users of the particular site's policy regarding connection. Presenting a warning message prior to the normal user login may assist the prosecution of trespassers on the computer system.</div><div class="container">- Current settings:</div><div class="container">banner none</div><div class="container">- Score pattern:</div><div class="container">== sshd -T | grep 'banner /etc/issue.net'</div><div class="container">- Command to execute:</div><div class="text-center container badge-danger">not scored (skipped)</div><div class="container">  5.2.19 Ensure SSH PAM is enabled</div><div class="container">- Description:</div><div class="container">UsePAM Enables the Pluggable Authentication Module interface. If set to “yes” this will enable PAM authentication using ChallengeResponseAuthentication and PasswordAuthentication in addition to PAM account and session module processing for all authentication types.</div><div class="container">- Rationale:</div><div class="container">When usePAM is set to yes, PAM runs through account and session types properly. This is important if you want to restrict access to services based off of IP, time or other factors of the account. Additionally, you can make sure users inherit certain environment variables on login or disallow access to the server</div><div class="container">- Current settings:</div><div class="container">usepam yes</div><div class="container">- Score pattern:</div><div class="container">== sshd -T | grep -i 'usepam yes'</div><div class="text-center container badge-success">scored</div><div class="container">  5.2.20 Ensure SSH AllowTcpForwarding is disabled</div><div class="container">- Description:</div><div class="container">SSH port forwarding is a mechanism in SSH for tunneling application ports from the client to the server, or servers to clients. It can be used for adding encryption to legacy applications, going through firewalls, and some system administrators and IT professionals use it for opening backdoors into the internal network from their home machines.</div><div class="container">- Rationale:</div><div class="container">Leaving port forwarding enabled can expose the organization to security risks and backdoors.</div><div class="container">SSH connections are protected with strong encryption. This makes their contents invisible to most deployed network monitoring and traffic filtering solutions. This invisibility carries considerable risk potential if it is used for malicious purposes such as data exfiltration. Cybercriminals or malware could exploit SSH to hide their unauthorized communications, or to exfiltrate stolen data from the target network</div><div class="container">- Current settings:</div><div class="container">allowtcpforwarding yes</div><div class="container">- Score pattern:</div><div class="container">== sshd -T | grep -i 'allowtcpforwarding no'</div><div class="container">- Command to execute:</div><div class="container">sed --in-place "s/^.*AllowTcpForwarding.*$/AllowTcpForwarding no/" /etc/ssh/sshd_config</div><div class="text-center container badge-danger">not scored (skipped)</div><div class="container">  5.2.21 Ensure SSH MaxStartups is configured</div><div class="container">- Description:</div><div class="container">The MaxStartups parameter specifies the maximum number of concurrent unauthenticated connections to the SSH daemon.</div><div class="container">Note: Local site policy may be more restrictive.</div><div class="container">- Rationale:</div><div class="container">To protect a system from denial of service due to a large number of pending authentication connection attempts, use the rate limiting function of MaxStartups to protect availability of sshd logins and prevent overwhelming the daemon.</div><div class="container">- Current settings:</div><div class="container">maxstartups 10:30:100</div><div class="container">- Score pattern:</div><div class="container">== sshd -T | grep -i 'maxstartups 10:30:100'</div><div class="text-center container badge-success">scored</div><div class="container">  5.2.22 Ensure SSH MaxSessions is limited</div><div class="container">- Description:</div><div class="container">The MaxSessions parameter specifies the maximum number of open sessions permitted from a given connection.</div><div class="container">Note: Local site policy may be more restrictive.</div><div class="container">- Rationale:</div><div class="container">To protect a system from denial of service due to a large number of concurrent sessions, use the rate limiting function of MaxSessions to protect availability of sshd logins and prevent overwhelming the daemon.</div><div class="container">- Current settings:</div><div class="container">10</div><div class="container">- Score pattern:</div><div class="container">== 10</div><div class="text-center container badge-success">scored</div><div class="container">__________________________________________________________________________________________________________________</div></body>
</html>
